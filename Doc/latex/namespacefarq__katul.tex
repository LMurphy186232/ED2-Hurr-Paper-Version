\hypertarget{namespacefarq__katul}{}\doxysection{farq\+\_\+katul Module Reference}
\label{namespacefarq__katul}\index{farq\_katul@{farq\_katul}}


Solve Farquhar Photosynthesis model together with Katul optimization-\/based stomata conductance model.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacefarq__katul_aca5faf9bb74a3aec28ae4439e5a41fb8}{katul\+\_\+lphys}} (ib, can\+\_\+prss, can\+\_\+rhos, can\+\_\+shv, can\+\_\+co2, ipft, leaf\+\_\+par, leaf\+\_\+temp, lint\+\_\+shv, green\+\_\+leaf\+\_\+factor, leaf\+\_\+aging\+\_\+factor, vm\+\_\+bar, rd\+\_\+bar, leaf\+\_\+gbw, leaf\+\_\+psi, dmax\+\_\+leaf\+\_\+psi, A\+\_\+open, A\+\_\+closed, A\+\_\+light, A\+\_\+rubp, A\+\_\+co2, gsw\+\_\+open, gsw\+\_\+closed, lsfc\+\_\+shv\+\_\+open, lsfc\+\_\+shv\+\_\+closed, lsfc\+\_\+co2\+\_\+open, lsfc\+\_\+co2\+\_\+closed, lint\+\_\+co2\+\_\+open, lint\+\_\+co2\+\_\+closed, leaf\+\_\+resp, vmout, jmout, tpmout, jactout, comppout, limit\+\_\+flag)
\begin{DoxyCompactList}\small\item\em Main driver to calculate Farquhar-\/\+Katul photosynthesis system. Alternative to lphysio\+\_\+full in \mbox{\hyperlink{namespacefarq__leuning}{farq\+\_\+leuning}}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefarq__katul_a7030dba05096822953f39808a0be934c}{optimization\+\_\+solver8}} (ib, ipft, lambda, opt\+\_\+ci, opt\+\_\+fc, opt\+\_\+gsc, opt\+\_\+ci\+\_\+closed, opt\+\_\+fc\+\_\+closed, opt\+\_\+gsc\+\_\+closed, opt\+\_\+fc\+\_\+rubp, opt\+\_\+fc\+\_\+light, opt\+\_\+fc\+\_\+3rd, limit\+\_\+flag)
\begin{DoxyCompactList}\small\item\em Solver for the stomatal optimization problem. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefarq__katul_a0be2fbc25a068c35a85fafc9af998817}{photosynthesis\+\_\+stomata\+\_\+solver8}} (ib, gsc, limit\+\_\+case, ci, fc, fe, dcidg, dfcdg, dfedg)
\begin{DoxyCompactList}\small\item\em Solver for photosynthesis and its derivatives wrt. gsc. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Solve Farquhar Photosynthesis model together with Katul optimization-\/based stomata conductance model. 

The optimization framework is to maximize A -\/ stoma\+\_\+lambda $\ast$ E every model time step. Currently the optimization is acheived using regula falsi. The module only The references are\+:~\newline
 Xu et al. (2016) Diversity in plant hydraulic traits explains seasonal and inter-\/annual variations in vegetation dynamics in seasonally dry tropical forests. New Phytologist~\newline
~\newline
 Manzoni, S., G. Vico, et al. (2011). \char`\"{}\+Optimizing stomatal conductance for maximum  carbon gain under water stress\+: a meta-\/analysis across plant functional types  and climates.\char`\"{} Functional Ecology 25(3)\+: 456-\/467.~\newline
~\newline
 Vico, G., S. Manzoni, et al. (2013). \char`\"{}\+A perspective on optimal leaf  stomatal conductance under CO2 and light co-\/limitations.\char`\"{} Agricultural and Forest Meteorology 182--183(0)\+: 191-\/199.~\newline
~\newline
 Katul, G., S. Manzoni, et al. (2010). \char`\"{}\+A stomatal optimization theory to describe  the effects of atmospheric CO2 on leaf photosynthesis and transpiration.\char`\"{} Annals of Botany 105(3)\+: 431-\/442. \begin{DoxyAuthor}{Author}
Xiangtao Xu, 18 MAY 2020 
\end{DoxyAuthor}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacefarq__katul_aca5faf9bb74a3aec28ae4439e5a41fb8}\label{namespacefarq__katul_aca5faf9bb74a3aec28ae4439e5a41fb8}} 
\index{farq\_katul@{farq\_katul}!katul\_lphys@{katul\_lphys}}
\index{katul\_lphys@{katul\_lphys}!farq\_katul@{farq\_katul}}
\doxysubsubsection{\texorpdfstring{katul\_lphys()}{katul\_lphys()}}
{\footnotesize\ttfamily subroutine farq\+\_\+katul\+::katul\+\_\+lphys (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ib,  }\item[{real(kind=4), intent(in)}]{can\+\_\+prss,  }\item[{real(kind=4), intent(in)}]{can\+\_\+rhos,  }\item[{real(kind=4), intent(in)}]{can\+\_\+shv,  }\item[{real(kind=4), intent(in)}]{can\+\_\+co2,  }\item[{integer, intent(in)}]{ipft,  }\item[{real(kind=4), intent(in)}]{leaf\+\_\+par,  }\item[{real(kind=4), intent(in)}]{leaf\+\_\+temp,  }\item[{real(kind=4), intent(in)}]{lint\+\_\+shv,  }\item[{real(kind=4), intent(in)}]{green\+\_\+leaf\+\_\+factor,  }\item[{real(kind=4), intent(in)}]{leaf\+\_\+aging\+\_\+factor,  }\item[{real(kind=4), intent(in)}]{vm\+\_\+bar,  }\item[{real(kind=4), intent(in)}]{rd\+\_\+bar,  }\item[{real(kind=4), intent(in)}]{leaf\+\_\+gbw,  }\item[{real(kind=4), intent(in)}]{leaf\+\_\+psi,  }\item[{real(kind=4), intent(in)}]{dmax\+\_\+leaf\+\_\+psi,  }\item[{real(kind=4), intent(out)}]{A\+\_\+open,  }\item[{real(kind=4), intent(out)}]{A\+\_\+closed,  }\item[{real(kind=4), intent(out)}]{A\+\_\+light,  }\item[{real(kind=4), intent(out)}]{A\+\_\+rubp,  }\item[{real(kind=4), intent(out)}]{A\+\_\+co2,  }\item[{real(kind=4), intent(out)}]{gsw\+\_\+open,  }\item[{real(kind=4), intent(out)}]{gsw\+\_\+closed,  }\item[{real(kind=4), intent(out)}]{lsfc\+\_\+shv\+\_\+open,  }\item[{real(kind=4), intent(out)}]{lsfc\+\_\+shv\+\_\+closed,  }\item[{real(kind=4), intent(out)}]{lsfc\+\_\+co2\+\_\+open,  }\item[{real(kind=4), intent(out)}]{lsfc\+\_\+co2\+\_\+closed,  }\item[{real(kind=4), intent(out)}]{lint\+\_\+co2\+\_\+open,  }\item[{real(kind=4), intent(out)}]{lint\+\_\+co2\+\_\+closed,  }\item[{real(kind=4), intent(out)}]{leaf\+\_\+resp,  }\item[{real(kind=4), intent(out)}]{vmout,  }\item[{real(kind=4), intent(out)}]{jmout,  }\item[{real(kind=4), intent(out)}]{tpmout,  }\item[{real(kind=4), intent(out)}]{jactout,  }\item[{real(kind=4), intent(out)}]{comppout,  }\item[{integer, intent(out)}]{limit\+\_\+flag }\end{DoxyParamCaption})}



Main driver to calculate Farquhar-\/\+Katul photosynthesis system. Alternative to lphysio\+\_\+full in \mbox{\hyperlink{namespacefarq__leuning}{farq\+\_\+leuning}}. 

The realized Vcmax is reduced under low leaf water potential while leaf dark respiration keeps the same. \begin{DoxyAuthor}{Author}
Xiangtao Xu, 15 Feb. 2018 
\end{DoxyAuthor}
\mbox{\Hypertarget{namespacefarq__katul_a7030dba05096822953f39808a0be934c}\label{namespacefarq__katul_a7030dba05096822953f39808a0be934c}} 
\index{farq\_katul@{farq\_katul}!optimization\_solver8@{optimization\_solver8}}
\index{optimization\_solver8@{optimization\_solver8}!farq\_katul@{farq\_katul}}
\doxysubsubsection{\texorpdfstring{optimization\_solver8()}{optimization\_solver8()}}
{\footnotesize\ttfamily subroutine farq\+\_\+katul\+::optimization\+\_\+solver8 (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ib,  }\item[{integer, intent(in)}]{ipft,  }\item[{real(kind=8), intent(in)}]{lambda,  }\item[{real(kind=8), intent(out)}]{opt\+\_\+ci,  }\item[{real(kind=8), intent(out)}]{opt\+\_\+fc,  }\item[{real(kind=8), intent(out)}]{opt\+\_\+gsc,  }\item[{real(kind=8), intent(out)}]{opt\+\_\+ci\+\_\+closed,  }\item[{real(kind=8), intent(out)}]{opt\+\_\+fc\+\_\+closed,  }\item[{real(kind=8), intent(out)}]{opt\+\_\+gsc\+\_\+closed,  }\item[{real(kind=8), intent(out)}]{opt\+\_\+fc\+\_\+rubp,  }\item[{real(kind=8), intent(out)}]{opt\+\_\+fc\+\_\+light,  }\item[{real(kind=8), intent(out)}]{opt\+\_\+fc\+\_\+3rd,  }\item[{integer, intent(out)}]{limit\+\_\+flag }\end{DoxyParamCaption})}



Solver for the stomatal optimization problem. 

Use Regular Falsi to search for the optimum \begin{DoxyAuthor}{Author}
Xiangtao Xu, 19 MAY 2018 
\end{DoxyAuthor}
\mbox{\Hypertarget{namespacefarq__katul_a0be2fbc25a068c35a85fafc9af998817}\label{namespacefarq__katul_a0be2fbc25a068c35a85fafc9af998817}} 
\index{farq\_katul@{farq\_katul}!photosynthesis\_stomata\_solver8@{photosynthesis\_stomata\_solver8}}
\index{photosynthesis\_stomata\_solver8@{photosynthesis\_stomata\_solver8}!farq\_katul@{farq\_katul}}
\doxysubsubsection{\texorpdfstring{photosynthesis\_stomata\_solver8()}{photosynthesis\_stomata\_solver8()}}
{\footnotesize\ttfamily subroutine farq\+\_\+katul\+::photosynthesis\+\_\+stomata\+\_\+solver8 (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ib,  }\item[{real(kind=8), intent(in)}]{gsc,  }\item[{character(len=$\ast$), intent(in)}]{limit\+\_\+case,  }\item[{real(kind=8), intent(out)}]{ci,  }\item[{real(kind=8), intent(out)}]{fc,  }\item[{real(kind=8), intent(out)}]{fe,  }\item[{real(kind=8), intent(out)}]{dcidg,  }\item[{real(kind=8), intent(out)}]{dfcdg,  }\item[{real(kind=8), intent(out)}]{dfedg }\end{DoxyParamCaption})}



Solver for photosynthesis and its derivatives wrt. gsc. 

Both C3 and C4 have three cases of limitation\+:~\newline
 C3\+: Light, Ru\+Bis\+CO, TPU~\newline
 C4\+: Light, Ru\+Bis\+CO, CO2~\newline
 \begin{DoxyAuthor}{Author}
Xiangtao Xu, 19 MAY 2018 
\end{DoxyAuthor}
