<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ED2: fuse_fiss_utils Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ED2
   </div>
   <div id="projectbrief">Ecosystem Demography Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">fuse_fiss_utils Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Routines to terminate and fuse patches, and to terminate, fuse and split cohorts.  
<a href="namespacefuse__fiss__utils.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a31e4835d2465d1400c7cbbb51976b341"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a31e4835d2465d1400c7cbbb51976b341">sort_cohorts</a> (cpatch)</td></tr>
<tr class="memdesc:a31e4835d2465d1400c7cbbb51976b341"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will sort the cohorts by size (1st = tallest, last = shortest.)  <a href="namespacefuse__fiss__utils.html#a31e4835d2465d1400c7cbbb51976b341">More...</a><br /></td></tr>
<tr class="separator:a31e4835d2465d1400c7cbbb51976b341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8afe150340753f32f88a5033afb66ff1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a8afe150340753f32f88a5033afb66ff1">terminate_cohorts</a> (csite, ipa, cmet, is_initial, elim_nplant, elim_lai)</td></tr>
<tr class="memdesc:a8afe150340753f32f88a5033afb66ff1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will eliminate cohorts based on their sizes. This is intended to eliminate cohorts that have little contribution and thus we can speed up the run.  <a href="namespacefuse__fiss__utils.html#a8afe150340753f32f88a5033afb66ff1">More...</a><br /></td></tr>
<tr class="separator:a8afe150340753f32f88a5033afb66ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac687a950d92b23661a3d3ef73b723201"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#ac687a950d92b23661a3d3ef73b723201">terminate_patches</a> (csite, lai_criterion)</td></tr>
<tr class="memdesc:ac687a950d92b23661a3d3ef73b723201"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will eliminate tiny or empty patches. This is intended to eliminate patches that have little contribution and thus we can speed up the run.  <a href="namespacefuse__fiss__utils.html#ac687a950d92b23661a3d3ef73b723201">More...</a><br /></td></tr>
<tr class="separator:ac687a950d92b23661a3d3ef73b723201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3b0eeed8a63cc2f4b866ac243e25ec6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#ab3b0eeed8a63cc2f4b866ac243e25ec6">rescale_patches</a> (csite)</td></tr>
<tr class="memdesc:ab3b0eeed8a63cc2f4b866ac243e25ec6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will rescale the area of the patches. This is almost the same as the terminate_patches subroutine, except that no patch is removed.  <a href="namespacefuse__fiss__utils.html#ab3b0eeed8a63cc2f4b866ac243e25ec6">More...</a><br /></td></tr>
<tr class="separator:ab3b0eeed8a63cc2f4b866ac243e25ec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e649bf27d8b87ff164e16ba0c3bccb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a58e649bf27d8b87ff164e16ba0c3bccb">new_fuse_cohorts</a> (csite, ipa, lsl, fuse_initial)</td></tr>
<tr class="memdesc:a58e649bf27d8b87ff164e16ba0c3bccb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will perform cohort fusion based on various similarity criteria to determine whether they can be fused with no significant loss of information.  <a href="namespacefuse__fiss__utils.html#a58e649bf27d8b87ff164e16ba0c3bccb">More...</a><br /></td></tr>
<tr class="separator:a58e649bf27d8b87ff164e16ba0c3bccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a331f78834118341c99058f69325c95fc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a331f78834118341c99058f69325c95fc">old_fuse_cohorts</a> (csite, ipa, lsl, fuse_initial)</td></tr>
<tr class="separator:a331f78834118341c99058f69325c95fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca6c05e04827c45b18ddb564c537de9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#acca6c05e04827c45b18ddb564c537de9">split_cohorts</a> (csite, ipa, green_leaf_factor, is_initial)</td></tr>
<tr class="memdesc:acca6c05e04827c45b18ddb564c537de9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will split two cohorts if its LAI has become too large.  <a href="namespacefuse__fiss__utils.html#acca6c05e04827c45b18ddb564c537de9">More...</a><br /></td></tr>
<tr class="separator:acca6c05e04827c45b18ddb564c537de9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fc600375d38f7ddcf60ebf5da725971"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a2fc600375d38f7ddcf60ebf5da725971">fuse_2_cohorts</a> (cpatch, donc, recc, can_prss, can_shv, lsl, fuse_initial)</td></tr>
<tr class="memdesc:a2fc600375d38f7ddcf60ebf5da725971"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will merge two cohorts into 1.  <a href="namespacefuse__fiss__utils.html#a2fc600375d38f7ddcf60ebf5da725971">More...</a><br /></td></tr>
<tr class="separator:a2fc600375d38f7ddcf60ebf5da725971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a546d7beff2f991a07c8fbba91921ce5f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a546d7beff2f991a07c8fbba91921ce5f">sort_patches</a> (csite)</td></tr>
<tr class="separator:a546d7beff2f991a07c8fbba91921ce5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab15ffcdcb79ee2bcb69f5a9954ca14ea"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#ab15ffcdcb79ee2bcb69f5a9954ca14ea">new_fuse_patches</a> (cgrid, ifm, fuse_initial)</td></tr>
<tr class="separator:ab15ffcdcb79ee2bcb69f5a9954ca14ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6776a45b5a81e01186fbac86854c6741"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a6776a45b5a81e01186fbac86854c6741">old_fuse_patches</a> (cgrid, ifm, fuse_initial)</td></tr>
<tr class="memdesc:a6776a45b5a81e01186fbac86854c6741"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will perform patch fusion based on some similarity criteria to determine whether they can be fused with no significant loss of information.  <a href="namespacefuse__fiss__utils.html#a6776a45b5a81e01186fbac86854c6741">More...</a><br /></td></tr>
<tr class="separator:a6776a45b5a81e01186fbac86854c6741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d06bb3b18a9c6bf45b3cc30b01cb4be"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a9d06bb3b18a9c6bf45b3cc30b01cb4be">fuse_2_patches</a> (csite, donp, recp, mzg, mzs, cmet, lsl, ntext_soil, green_leaf_factor, fuse_initial, elim_nplant, elim_lai)</td></tr>
<tr class="memdesc:a9d06bb3b18a9c6bf45b3cc30b01cb4be"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will merge two patches into 1.  <a href="namespacefuse__fiss__utils.html#a9d06bb3b18a9c6bf45b3cc30b01cb4be">More...</a><br /></td></tr>
<tr class="separator:a9d06bb3b18a9c6bf45b3cc30b01cb4be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae52213c98fe3ffb3ecde24d8ffc6e03"><td class="memItemLeft" align="right" valign="top">real(kind=4) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#aae52213c98fe3ffb3ecde24d8ffc6e03">fuse_msqu</a> (xmean, xmsqu, xwght, ymean, ymsqu, ywght, r_xy, extensive)</td></tr>
<tr class="memdesc:aae52213c98fe3ffb3ecde24d8ffc6e03"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine combines the mean sum of squares of two quantities (x and y).  <a href="namespacefuse__fiss__utils.html#aae52213c98fe3ffb3ecde24d8ffc6e03">More...</a><br /></td></tr>
<tr class="separator:aae52213c98fe3ffb3ecde24d8ffc6e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace5e880797709c6be154c2ce38803f08"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#ace5e880797709c6be154c2ce38803f08">check_bfusion_patch</a> (csite, osite, lsl, ipa)</td></tr>
<tr class="separator:ace5e880797709c6be154c2ce38803f08"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Routines to terminate and fuse patches, and to terminate, fuse and split cohorts. </p>
<dl class="section author"><dt>Author</dt><dd>Translated from ED1 by David Medivgy, Ryan Knox and Marcos Longo </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ace5e880797709c6be154c2ce38803f08" name="ace5e880797709c6be154c2ce38803f08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace5e880797709c6be154c2ce38803f08">&#9670;&nbsp;</a></span>check_bfusion_patch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::check_bfusion_patch </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>osite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2fc600375d38f7ddcf60ebf5da725971" name="a2fc600375d38f7ddcf60ebf5da725971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fc600375d38f7ddcf60ebf5da725971">&#9670;&nbsp;</a></span>fuse_2_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::fuse_2_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1patchtype.html">patchtype</a>), target&#160;</td>
          <td class="paramname"><em>cpatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>donc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>recc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>can_prss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>can_shv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will merge two cohorts into 1. </p>
<p >The donating cohort (donc) is the one that will be deallocated, while the receptor cohort (recc) will contain the information from both cohorts. </p>

</div>
</div>
<a id="a9d06bb3b18a9c6bf45b3cc30b01cb4be" name="a9d06bb3b18a9c6bf45b3cc30b01cb4be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d06bb3b18a9c6bf45b3cc30b01cb4be">&#9670;&nbsp;</a></span>fuse_2_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::fuse_2_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>donp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>recp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mzg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mzs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmet__driver__coms_1_1met__driv__state.html">met_driv_state</a>), target&#160;</td>
          <td class="paramname"><em>cmet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(mzg), intent(in)&#160;</td>
          <td class="paramname"><em>ntext_soil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n_pft), intent(in)&#160;</td>
          <td class="paramname"><em>green_leaf_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>elim_nplant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>elim_lai</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will merge two patches into 1. </p>

</div>
</div>
<a id="aae52213c98fe3ffb3ecde24d8ffc6e03" name="aae52213c98fe3ffb3ecde24d8ffc6e03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae52213c98fe3ffb3ecde24d8ffc6e03">&#9670;&nbsp;</a></span>fuse_msqu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4) function fuse_fiss_utils::fuse_msqu </td>
          <td>(</td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>xmean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>xmsqu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>xwght</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>ymean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>ymsqu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>ywght</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>r_xy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>extensive</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine combines the mean sum of squares of two quantities (x and y). </p>

</div>
</div>
<a id="a58e649bf27d8b87ff164e16ba0c3bccb" name="a58e649bf27d8b87ff164e16ba0c3bccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58e649bf27d8b87ff164e16ba0c3bccb">&#9670;&nbsp;</a></span>new_fuse_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::new_fuse_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will perform cohort fusion based on various similarity criteria to determine whether they can be fused with no significant loss of information. </p>
<p >The user is welcome to set up a benchmark, but should be aware that no miracles will happen here. If there are more very distinct cohorts than maxcohort, then the user will need to live with that and accept life is not always fair with those with limited computational resources. <br  />
 </p>

</div>
</div>
<a id="ab15ffcdcb79ee2bcb69f5a9954ca14ea" name="ab15ffcdcb79ee2bcb69f5a9954ca14ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab15ffcdcb79ee2bcb69f5a9954ca14ea">&#9670;&nbsp;</a></span>new_fuse_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::new_fuse_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1edtype.html">edtype</a>), target&#160;</td>
          <td class="paramname"><em>cgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ifm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a331f78834118341c99058f69325c95fc" name="a331f78834118341c99058f69325c95fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a331f78834118341c99058f69325c95fc">&#9670;&nbsp;</a></span>old_fuse_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::old_fuse_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6776a45b5a81e01186fbac86854c6741" name="a6776a45b5a81e01186fbac86854c6741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6776a45b5a81e01186fbac86854c6741">&#9670;&nbsp;</a></span>old_fuse_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::old_fuse_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1edtype.html">edtype</a>), target&#160;</td>
          <td class="paramname"><em>cgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ifm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will perform patch fusion based on some similarity criteria to determine whether they can be fused with no significant loss of information. </p>
<p >The user is welcome to set up a benchmark, but they should be aware that no miracles will happen here. If there are more very distinct patches than maxpatch, then the user will need to live with that and accept life is not always fair with those with limited computational resources. </p><dl class="section warning"><dt>Warning</dt><dd>Cohort fusion may significantly affect the runs, so I am keeping both the old and new routines, but I think we should probably phase out this and stick with the new one. </dd></dl>

</div>
</div>
<a id="ab3b0eeed8a63cc2f4b866ac243e25ec6" name="ab3b0eeed8a63cc2f4b866ac243e25ec6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3b0eeed8a63cc2f4b866ac243e25ec6">&#9670;&nbsp;</a></span>rescale_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::rescale_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will rescale the area of the patches. This is almost the same as the terminate_patches subroutine, except that no patch is removed. </p>

</div>
</div>
<a id="a31e4835d2465d1400c7cbbb51976b341" name="a31e4835d2465d1400c7cbbb51976b341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e4835d2465d1400c7cbbb51976b341">&#9670;&nbsp;</a></span>sort_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::sort_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1patchtype.html">patchtype</a>), target&#160;</td>
          <td class="paramname"><em>cpatch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will sort the cohorts by size (1st = tallest, last = shortest.) </p>
<p >In case there is a tie (for example, when 2 cohorts have reached the maximum possible height, then we use DBH for tie breaking, and if they have the exact same DBH, then we simply pick the lowest index (as they are exactly the same). This could cause some problems when the new grass allometry is implemented, though. <br  />
 </p>

</div>
</div>
<a id="a546d7beff2f991a07c8fbba91921ce5f" name="a546d7beff2f991a07c8fbba91921ce5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a546d7beff2f991a07c8fbba91921ce5f">&#9670;&nbsp;</a></span>sort_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::sort_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acca6c05e04827c45b18ddb564c537de9" name="acca6c05e04827c45b18ddb564c537de9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acca6c05e04827c45b18ddb564c537de9">&#9670;&nbsp;</a></span>split_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::split_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n_pft), intent(in)&#160;</td>
          <td class="paramname"><em>green_leaf_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>is_initial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will split two cohorts if its LAI has become too large. </p>
<p >This is only necessary when we solve radiation cohort by cohort rather than layer by layer. </p>

</div>
</div>
<a id="a8afe150340753f32f88a5033afb66ff1" name="a8afe150340753f32f88a5033afb66ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8afe150340753f32f88a5033afb66ff1">&#9670;&nbsp;</a></span>terminate_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::terminate_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmet__driver__coms_1_1met__driv__state.html">met_driv_state</a>), target&#160;</td>
          <td class="paramname"><em>cmet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>is_initial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>elim_nplant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>elim_lai</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will eliminate cohorts based on their sizes. This is intended to eliminate cohorts that have little contribution and thus we can speed up the run. </p>

</div>
</div>
<a id="ac687a950d92b23661a3d3ef73b723201" name="ac687a950d92b23661a3d3ef73b723201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac687a950d92b23661a3d3ef73b723201">&#9670;&nbsp;</a></span>terminate_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::terminate_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>lai_criterion</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will eliminate tiny or empty patches. This is intended to eliminate patches that have little contribution and thus we can speed up the run. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
