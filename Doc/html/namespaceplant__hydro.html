<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ED2: plant_hydro Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ED2
   </div>
   <div id="projectbrief">Ecosystem Demography Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">plant_hydro Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Calculations of plant hydrodynamics at ED2 timestep, including various utils for plant hydraulics.  
<a href="namespaceplant__hydro.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:abfe8a320d427f69bf1406dfaa6451d78"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#abfe8a320d427f69bf1406dfaa6451d78">plant_hydro_driver</a> (csite, ipa, ntext_soil)</td></tr>
<tr class="memdesc:abfe8a320d427f69bf1406dfaa6451d78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main driver to calculate plant hydrodynamics within a site.  <a href="namespaceplant__hydro.html#abfe8a320d427f69bf1406dfaa6451d78">More...</a><br /></td></tr>
<tr class="separator:abfe8a320d427f69bf1406dfaa6451d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae182f350bc482ea1c98058bdd24a7c15"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#ae182f350bc482ea1c98058bdd24a7c15">calc_plant_water_flux</a> (dt, sap_area, nplant, ipft, is_small, krdepth, bleaf, bsap, broot, hite, transp, leaf_psi, wood_psi, soil_psi, soil_cond, ipa, ico, wflux_wl, wflux_gw, wflux_gw_layer)</td></tr>
<tr class="memdesc:ae182f350bc482ea1c98058bdd24a7c15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate water flow within plants driven by hydraulic laws.  <a href="namespaceplant__hydro.html#ae182f350bc482ea1c98058bdd24a7c15">More...</a><br /></td></tr>
<tr class="separator:ae182f350bc482ea1c98058bdd24a7c15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae27d78c83f41d9d6fdd38ad2052b32af"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#ae27d78c83f41d9d6fdd38ad2052b32af">psi2rwc</a> (leaf_psi, wood_psi, ipft, leaf_rwc, wood_rwc)</td></tr>
<tr class="memdesc:ae27d78c83f41d9d6fdd38ad2052b32af"><td class="mdescLeft">&#160;</td><td class="mdescRight">\breif Convert water potential of leaf and wood to relative water content  <a href="namespaceplant__hydro.html#ae27d78c83f41d9d6fdd38ad2052b32af">More...</a><br /></td></tr>
<tr class="separator:ae27d78c83f41d9d6fdd38ad2052b32af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cc35f0ea4e11517e3bc7eb75fd19e36"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a7cc35f0ea4e11517e3bc7eb75fd19e36">rwc2psi</a> (leaf_rwc, wood_rwc, ipft, leaf_psi, wood_psi)</td></tr>
<tr class="memdesc:a7cc35f0ea4e11517e3bc7eb75fd19e36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert relative water content to water potential.  <a href="namespaceplant__hydro.html#a7cc35f0ea4e11517e3bc7eb75fd19e36">More...</a><br /></td></tr>
<tr class="separator:a7cc35f0ea4e11517e3bc7eb75fd19e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7799ce8ba25fef66ade9730bc9f6c77"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#af7799ce8ba25fef66ade9730bc9f6c77">rwc2tw</a> (leaf_rwc, wood_rwc, bleaf, bsapwooda, bsapwoodb, bdeada, bdeadb, broot, dbh, ipft, leaf_water_int, wood_water_int)</td></tr>
<tr class="memdesc:af7799ce8ba25fef66ade9730bc9f6c77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert relative water content to total water for both leaf and wood.  <a href="namespaceplant__hydro.html#af7799ce8ba25fef66ade9730bc9f6c77">More...</a><br /></td></tr>
<tr class="separator:af7799ce8ba25fef66ade9730bc9f6c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09860c21fcc80cc71cd5d5c11ff2ddd2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a09860c21fcc80cc71cd5d5c11ff2ddd2">tw2rwc</a> (leaf_water_int, wood_water_int, is_small, bleaf, bsapwooda, bsapwoodb, bdeada, bdeadb, broot, dbh, ipft, leaf_rwc, wood_rwc)</td></tr>
<tr class="memdesc:a09860c21fcc80cc71cd5d5c11ff2ddd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert total water to relative water content for both leaf and wood.  <a href="namespaceplant__hydro.html#a09860c21fcc80cc71cd5d5c11ff2ddd2">More...</a><br /></td></tr>
<tr class="separator:a09860c21fcc80cc71cd5d5c11ff2ddd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f7b187fbc4e18ea8c2329f506ac674e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a8f7b187fbc4e18ea8c2329f506ac674e">psi2tw</a> (leaf_psi, wood_psi, bleaf, bsapwooda, bsapwoodb, bdeada, bdeadb, broot, dbh, ipft, leaf_water_int, wood_water_int)</td></tr>
<tr class="memdesc:a8f7b187fbc4e18ea8c2329f506ac674e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert water potential to total water for both leaf and wood.  <a href="namespaceplant__hydro.html#a8f7b187fbc4e18ea8c2329f506ac674e">More...</a><br /></td></tr>
<tr class="separator:a8f7b187fbc4e18ea8c2329f506ac674e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fb5bda697f01054edcbfc46d216dbfc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a1fb5bda697f01054edcbfc46d216dbfc">tw2psi</a> (leaf_water_int, wood_water_int, is_small, bleaf, bsapwooda, bsapwoodb, bdeada, bdeadb, broot, dbh, ipft, leaf_psi, wood_psi)</td></tr>
<tr class="memdesc:a1fb5bda697f01054edcbfc46d216dbfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert total water to water potential for both leaf and wood.  <a href="namespaceplant__hydro.html#a1fb5bda697f01054edcbfc46d216dbfc">More...</a><br /></td></tr>
<tr class="separator:a1fb5bda697f01054edcbfc46d216dbfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac96b04cb776694987ccefd7c37aab829"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#ac96b04cb776694987ccefd7c37aab829">twi2twe</a> (leaf_water_int, wood_water_int, nplant, leaf_water_im2, wood_water_im2)</td></tr>
<tr class="memdesc:ac96b04cb776694987ccefd7c37aab829"><td class="mdescLeft">&#160;</td><td class="mdescRight">Intensive to extensive internal water converter.  <a href="namespaceplant__hydro.html#ac96b04cb776694987ccefd7c37aab829">More...</a><br /></td></tr>
<tr class="separator:ac96b04cb776694987ccefd7c37aab829"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeec57a396eb838de8a254337d9b9851d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#aeec57a396eb838de8a254337d9b9851d">twe2twi</a> (leaf_water_im2, wood_water_im2, nplant, leaf_water_int, wood_water_int)</td></tr>
<tr class="memdesc:aeec57a396eb838de8a254337d9b9851d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extensive to extensive internal water converter.  <a href="namespaceplant__hydro.html#aeec57a396eb838de8a254337d9b9851d">More...</a><br /></td></tr>
<tr class="separator:aeec57a396eb838de8a254337d9b9851d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac89709711c9ca9b56ed327f767e842c2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#ac89709711c9ca9b56ed327f767e842c2">psi2twe</a> (leaf_psi, wood_psi, ipft, nplant, bleaf, bsapwooda, bsapwoodb, bdeada, bdeadb, broot, dbh, leaf_water_im2, wood_water_im2)</td></tr>
<tr class="memdesc:ac89709711c9ca9b56ed327f767e842c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">\breif Convert water potential of leaf and wood to extensive water storage  <a href="namespaceplant__hydro.html#ac89709711c9ca9b56ed327f767e842c2">More...</a><br /></td></tr>
<tr class="separator:ac89709711c9ca9b56ed327f767e842c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee5e9b3f26944e3c39aa053c891d534c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#aee5e9b3f26944e3c39aa053c891d534c">update_plc</a> (cpatch, ico)</td></tr>
<tr class="memdesc:aee5e9b3f26944e3c39aa053c891d534c"><td class="mdescLeft">&#160;</td><td class="mdescRight">\breif update percentage loss of xylem conductance using daily minimum leaf psi  <a href="namespaceplant__hydro.html#aee5e9b3f26944e3c39aa053c891d534c">More...</a><br /></td></tr>
<tr class="separator:aee5e9b3f26944e3c39aa053c891d534c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac287cbcde462cfff9ae16f742d5358e2"><td class="memItemLeft" align="right" valign="top">real(kind=4), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#ac287cbcde462cfff9ae16f742d5358e2">tol_buff</a> = 1.e-4</td></tr>
<tr class="separator:ac287cbcde462cfff9ae16f742d5358e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d699833137beb778a1a8fb615cb671f"><td class="memItemLeft" align="right" valign="top">real(kind=8), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a8d699833137beb778a1a8fb615cb671f">tol_buff_d</a> = dble(<a class="el" href="namespaceplant__hydro.html#ac287cbcde462cfff9ae16f742d5358e2">tol_buff</a>)</td></tr>
<tr class="separator:a8d699833137beb778a1a8fb615cb671f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c185febf0c7ef0df6dae91e4a7b52b8"><td class="memItemLeft" align="right" valign="top">real(kind=4), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a3c185febf0c7ef0df6dae91e4a7b52b8">om_buff</a> = 1. - <a class="el" href="namespaceplant__hydro.html#ac287cbcde462cfff9ae16f742d5358e2">tol_buff</a></td></tr>
<tr class="separator:a3c185febf0c7ef0df6dae91e4a7b52b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b260480ab407ab5c941319c7d35292c"><td class="memItemLeft" align="right" valign="top">real(kind=8), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a4b260480ab407ab5c941319c7d35292c">om_buff_d</a> = dble(<a class="el" href="namespaceplant__hydro.html#a3c185febf0c7ef0df6dae91e4a7b52b8">om_buff</a>)</td></tr>
<tr class="separator:a4b260480ab407ab5c941319c7d35292c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad54319c331bda02da512bf658a5d0e9"><td class="memItemLeft" align="right" valign="top">real(kind=4), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#aad54319c331bda02da512bf658a5d0e9">op_buff</a> = 1. + <a class="el" href="namespaceplant__hydro.html#ac287cbcde462cfff9ae16f742d5358e2">tol_buff</a></td></tr>
<tr class="separator:aad54319c331bda02da512bf658a5d0e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a920abe9cf8905c1050f158943e8366ff"><td class="memItemLeft" align="right" valign="top">real(kind=8), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a920abe9cf8905c1050f158943e8366ff">op_buff_d</a> = dble(<a class="el" href="namespaceplant__hydro.html#aad54319c331bda02da512bf658a5d0e9">op_buff</a>)</td></tr>
<tr class="separator:a920abe9cf8905c1050f158943e8366ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad08e1d2ab7bca169ad516ccf19c403fc"><td class="memItemLeft" align="right" valign="top">real(kind=4), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#ad08e1d2ab7bca169ad516ccf19c403fc">mg_safe</a> = 0.05</td></tr>
<tr class="separator:ad08e1d2ab7bca169ad516ccf19c403fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22708ca7ad47af7e684fd28aa7b2afd2"><td class="memItemLeft" align="right" valign="top">real(kind=4), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a22708ca7ad47af7e684fd28aa7b2afd2">op_safe</a> = 1. + <a class="el" href="namespaceplant__hydro.html#ad08e1d2ab7bca169ad516ccf19c403fc">mg_safe</a></td></tr>
<tr class="separator:a22708ca7ad47af7e684fd28aa7b2afd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a467362cb40e4cd045610d079df4a4385"><td class="memItemLeft" align="right" valign="top">real(kind=4), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceplant__hydro.html#a467362cb40e4cd045610d079df4a4385">om_safe</a> = 1. - <a class="el" href="namespaceplant__hydro.html#ad08e1d2ab7bca169ad516ccf19c403fc">mg_safe</a></td></tr>
<tr class="separator:a467362cb40e4cd045610d079df4a4385"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Calculations of plant hydrodynamics at ED2 timestep, including various utils for plant hydraulics. </p>
<p >Util functions to perform conversions between psi, rwc and water_int </p><dl class="section author"><dt>Author</dt><dd>Xiangtao Xu, 26 Jan. 2018 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae182f350bc482ea1c98058bdd24a7c15" name="ae182f350bc482ea1c98058bdd24a7c15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae182f350bc482ea1c98058bdd24a7c15">&#9670;&nbsp;</a></span>calc_plant_water_flux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::calc_plant_water_flux </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>sap_area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>nplant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>is_small</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>krdepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bleaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>broot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>hite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nzg), intent(in)&#160;</td>
          <td class="paramname"><em>soil_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nzg), intent(in)&#160;</td>
          <td class="paramname"><em>soil_cond</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ico</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wflux_wl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wflux_gw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nzg), intent(out)&#160;</td>
          <td class="paramname"><em>wflux_gw_layer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate water flow within plants driven by hydraulic laws. </p>
<p >This subroutine calculates ground to wood/root, and wood/root to leaf water flow from initial plant water potential and transpiration rates based on hydraulic laws. To simplify calculation and reduce numerial error, It is assumed that within one timestep, leaf water pool &lt;&lt; wood water pool &lt;&lt; soil water pool. Special cases are handled when these assumptions are incorrect such as grasses and very small seedlings.<br  />
 Note that this subroutine only update fluxes but not the water potential or water content, which will be updated within the RK4 Integrator. Currently, this subroutine works at DTLSM level, but it is straightforwad to implement the plant hydrodynamics within the RK4 integration scheme. Yet, it is not yet tested how much extra computational cost would it incur<br  />
 References:<br  />
 [X16] Xu X, Medvigy D, Powers JS, Becknell JM , Guan K. 2016. Diversity in plant hydraulic traits explains seasonal and inter-annual variations of vegetation dynamics in seasonally dry tropical forests. New Phytol. 212: 80-95. doi:10.1111/nph.14009.</p>
<p >[K03] Katul G, Leuning R , Oren R. 2003. Relationship between plant hydraulic and biochemical properties derived from a steady-state coupled water and carbon transport model. Plant Cell Environ. 26: 339-350. doi:10.1046/j.1365-3040.2003.00965.x.</p>
<dl class="section author"><dt>Author</dt><dd>Xiangtao Xu, 29 Jan. 2018 </dd></dl>

</div>
</div>
<a id="abfe8a320d427f69bf1406dfaa6451d78" name="abfe8a320d427f69bf1406dfaa6451d78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfe8a320d427f69bf1406dfaa6451d78">&#9670;&nbsp;</a></span>plant_hydro_driver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::plant_hydro_driver </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nzg), intent(in)&#160;</td>
          <td class="paramname"><em>ntext_soil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main driver to calculate plant hydrodynamics within a site. </p>
<p >This subroutine works at DTLSM scale, similar to <a class="el" href="namespacephotosyn__driv.html" title="Main photosynthesis driver.">photosyn_driv</a>. Keep in mind that this subroutine uses average transpiration from last timestep. Therefore, we should also use water potential at the start of the last timestep. <br  />
 Alternatively, one can directly call calc_plant_water_flux subroutine within the <a class="el" href="rk4__derivs_8f90.html">rk4_derivs.f90</a>, which will give an estimate of water flux within each integration timestep using the transpiration/water potential at the start of the integration timestep. However, this can incur extra computational cost.</p>
<dl class="section author"><dt>Author</dt><dd>Xiangtao Xu, 30 Jan. 2018 </dd></dl>

</div>
</div>
<a id="ae27d78c83f41d9d6fdd38ad2052b32af" name="ae27d78c83f41d9d6fdd38ad2052b32af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae27d78c83f41d9d6fdd38ad2052b32af">&#9670;&nbsp;</a></span>psi2rwc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::psi2rwc </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>leaf_rwc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wood_rwc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>\breif Convert water potential of leaf and wood to relative water content </p>
<p >Here we assume a constant hydraulic capacitance for both leaf and wood. From the definition of hydraulic capacitance we have <br  />
 hydro_cap = delta_water_content / delta_psi <br  />
 Since psi = 0. when water_content is at saturation, we have <br  />
 hydro_cap = (1. - rwc) * water_content_at_saturation / (0. - psi) <br  />
 Reorganize the equation above, we can get <br  />
 rwc = 1. + psi * hydro_cap / water_content_at_saturation </p>

</div>
</div>
<a id="a8f7b187fbc4e18ea8c2329f506ac674e" name="a8f7b187fbc4e18ea8c2329f506ac674e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f7b187fbc4e18ea8c2329f506ac674e">&#9670;&nbsp;</a></span>psi2tw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::psi2tw </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bleaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwooda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwoodb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeadb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>broot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dbh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>leaf_water_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wood_water_int</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert water potential to total water for both leaf and wood. </p>

</div>
</div>
<a id="ac89709711c9ca9b56ed327f767e842c2" name="ac89709711c9ca9b56ed327f767e842c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac89709711c9ca9b56ed327f767e842c2">&#9670;&nbsp;</a></span>psi2twe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::psi2twe </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>nplant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bleaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwooda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwoodb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeadb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>broot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dbh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>leaf_water_im2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wood_water_im2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>\breif Convert water potential of leaf and wood to extensive water storage </p>
<p >This sub-routine is useful when we need to go from water potential to storage, but we don't need the intermediate quantities (relative and individual water contents). </p>

</div>
</div>
<a id="a7cc35f0ea4e11517e3bc7eb75fd19e36" name="a7cc35f0ea4e11517e3bc7eb75fd19e36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc35f0ea4e11517e3bc7eb75fd19e36">&#9670;&nbsp;</a></span>rwc2psi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::rwc2psi </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_rwc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_rwc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>leaf_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wood_psi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert relative water content to water potential. </p>
<p >The inverse of psi2rwc </p>

</div>
</div>
<a id="af7799ce8ba25fef66ade9730bc9f6c77" name="af7799ce8ba25fef66ade9730bc9f6c77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7799ce8ba25fef66ade9730bc9f6c77">&#9670;&nbsp;</a></span>rwc2tw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::rwc2tw </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_rwc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_rwc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bleaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwooda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwoodb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeadb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>broot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dbh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>leaf_water_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wood_water_int</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert relative water content to total water for both leaf and wood. </p>
<p >total water content = <br  />
 relative water content * water_content_at_saturation * biomass </p><dl class="section warning"><dt>Warning</dt><dd>In the hydro version, bsapwood is set as 0 and bdead is assumedto contain both sapwood and heart wood. Root is counted as wood. When dynamic hydraulics is turned off, we account for water in sapwood using the sapwood biomass definition. </dd></dl>

</div>
</div>
<a id="a1fb5bda697f01054edcbfc46d216dbfc" name="a1fb5bda697f01054edcbfc46d216dbfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fb5bda697f01054edcbfc46d216dbfc">&#9670;&nbsp;</a></span>tw2psi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::tw2psi </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_water_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_water_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>is_small</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bleaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwooda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwoodb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeadb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>broot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dbh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>leaf_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wood_psi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert total water to water potential for both leaf and wood. </p>
<p >the inverse of psi2tw <br  />
</p>

</div>
</div>
<a id="a09860c21fcc80cc71cd5d5c11ff2ddd2" name="a09860c21fcc80cc71cd5d5c11ff2ddd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09860c21fcc80cc71cd5d5c11ff2ddd2">&#9670;&nbsp;</a></span>tw2rwc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::tw2rwc </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_water_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_water_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>is_small</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bleaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwooda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bsapwoodb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>bdeadb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>broot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dbh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>leaf_rwc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wood_rwc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert total water to relative water content for both leaf and wood. </p>
<p >the inverse of rwc2tw <br  />
</p>

</div>
</div>
<a id="aeec57a396eb838de8a254337d9b9851d" name="aeec57a396eb838de8a254337d9b9851d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeec57a396eb838de8a254337d9b9851d">&#9670;&nbsp;</a></span>twe2twi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::twe2twi </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_water_im2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_water_im2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>nplant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>leaf_water_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wood_water_int</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extensive to extensive internal water converter. </p>
<p >This subroutine converts extensive internal water (kg/m2) to extensive water content (kg/plant). To avoid energy leaks, we assume that all water stored in wood is included in the heat capacity. In the future, we should make it only the fraction associated with branches, but this requires additional changes in the budget checks. </p><dl class="section author"><dt>Author</dt><dd>Marcos Longo 08 Sep 2019 </dd></dl>

</div>
</div>
<a id="ac96b04cb776694987ccefd7c37aab829" name="ac96b04cb776694987ccefd7c37aab829"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac96b04cb776694987ccefd7c37aab829">&#9670;&nbsp;</a></span>twi2twe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::twi2twe </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>leaf_water_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wood_water_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>nplant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>leaf_water_im2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wood_water_im2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Intensive to extensive internal water converter. </p>
<p >This subroutine converts intensive internal water (kg/plant) to extensive water content (kg/m2). To avoid energy leaks, we assume that all water stored in sapwood is included in the heat capacity. This is not the most elegant solution, and in the future, we should make it only the fraction associated with branches, but this requires additional changes in the budget checks. </p><dl class="section author"><dt>Author</dt><dd>Marcos Longo 08 Sep 2019 </dd></dl>

</div>
</div>
<a id="aee5e9b3f26944e3c39aa053c891d534c" name="aee5e9b3f26944e3c39aa053c891d534c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee5e9b3f26944e3c39aa053c891d534c">&#9670;&nbsp;</a></span>update_plc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plant_hydro::update_plc </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1patchtype.html">patchtype</a>), target&#160;</td>
          <td class="paramname"><em>cpatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ico</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>\breif update percentage loss of xylem conductance using daily minimum leaf psi </p>
<p >This subroutine is called at daily time scale in <a class="el" href="growth__balive_8f90.html">growth_balive.f90</a> Daily minimum leaf psi is used because upper branch, which has similar water potential as leaf, should be the most vulnerable section along the hydraulic pathway </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad08e1d2ab7bca169ad516ccf19c403fc" name="ad08e1d2ab7bca169ad516ccf19c403fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad08e1d2ab7bca169ad516ccf19c403fc">&#9670;&nbsp;</a></span>mg_safe</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4), parameter plant_hydro::mg_safe = 0.05</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3c185febf0c7ef0df6dae91e4a7b52b8" name="a3c185febf0c7ef0df6dae91e4a7b52b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c185febf0c7ef0df6dae91e4a7b52b8">&#9670;&nbsp;</a></span>om_buff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4), parameter plant_hydro::om_buff = 1. - <a class="el" href="namespaceplant__hydro.html#ac287cbcde462cfff9ae16f742d5358e2">tol_buff</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4b260480ab407ab5c941319c7d35292c" name="a4b260480ab407ab5c941319c7d35292c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b260480ab407ab5c941319c7d35292c">&#9670;&nbsp;</a></span>om_buff_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), parameter plant_hydro::om_buff_d = dble(<a class="el" href="namespaceplant__hydro.html#a3c185febf0c7ef0df6dae91e4a7b52b8">om_buff</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a467362cb40e4cd045610d079df4a4385" name="a467362cb40e4cd045610d079df4a4385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a467362cb40e4cd045610d079df4a4385">&#9670;&nbsp;</a></span>om_safe</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4), parameter plant_hydro::om_safe = 1. - <a class="el" href="namespaceplant__hydro.html#ad08e1d2ab7bca169ad516ccf19c403fc">mg_safe</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aad54319c331bda02da512bf658a5d0e9" name="aad54319c331bda02da512bf658a5d0e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad54319c331bda02da512bf658a5d0e9">&#9670;&nbsp;</a></span>op_buff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4), parameter plant_hydro::op_buff = 1. + <a class="el" href="namespaceplant__hydro.html#ac287cbcde462cfff9ae16f742d5358e2">tol_buff</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a920abe9cf8905c1050f158943e8366ff" name="a920abe9cf8905c1050f158943e8366ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a920abe9cf8905c1050f158943e8366ff">&#9670;&nbsp;</a></span>op_buff_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), parameter plant_hydro::op_buff_d = dble(<a class="el" href="namespaceplant__hydro.html#aad54319c331bda02da512bf658a5d0e9">op_buff</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a22708ca7ad47af7e684fd28aa7b2afd2" name="a22708ca7ad47af7e684fd28aa7b2afd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22708ca7ad47af7e684fd28aa7b2afd2">&#9670;&nbsp;</a></span>op_safe</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4), parameter plant_hydro::op_safe = 1. + <a class="el" href="namespaceplant__hydro.html#ad08e1d2ab7bca169ad516ccf19c403fc">mg_safe</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac287cbcde462cfff9ae16f742d5358e2" name="ac287cbcde462cfff9ae16f742d5358e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac287cbcde462cfff9ae16f742d5358e2">&#9670;&nbsp;</a></span>tol_buff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4), parameter plant_hydro::tol_buff = 1.e-4</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8d699833137beb778a1a8fb615cb671f" name="a8d699833137beb778a1a8fb615cb671f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d699833137beb778a1a8fb615cb671f">&#9670;&nbsp;</a></span>tol_buff_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), parameter plant_hydro::tol_buff_d = dble(<a class="el" href="namespaceplant__hydro.html#ac287cbcde462cfff9ae16f742d5358e2">tol_buff</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
